var f=File.ReadAllText("i").Split("\n\n");var p=Enumerable.Range(0,f[0].Length-1).Select(i=>(l:f[0][i],r:f[0][i+1])).GroupBy(p=>p).Select(g=>(k:g.Key,v:g.LongCount())).ToDictionary(x=>x.k,x=>x.v);var r=f[1].Trim().Split('\n').ToDictionary(l=>(l[0],l[1]),l=>l[6]);for(int i=0;i<40;i++){Dictionary<(char,char),long>w=new();foreach(var(b,c)in p){var d=b with{l=r[b]};w[d]=(w.ContainsKey(d)?w[d]:0)+c;d=b with{r=r[b]};w[d]=(w.ContainsKey(d)?w[d]:0)+c;}p=w;}var s=p.Select(b=>(e:b.Key.r,c:b.Value)).Append((f[0][0],1)).GroupBy(b=>b.e,b=>b.c).Select(g=>g.Sum());Write(s.Max()-s.Min());